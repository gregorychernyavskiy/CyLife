stages:
  - androidbuild
  - androidtest

android-build:
  image: afirefly/android-ci:java17 # Docker image that has Android environments installed
  stage: androidbuild               # One of the stages listed above
  tags:
    - Dhvani_tag                    # Change to your runner's tag
  before_script:                    # Enable gradlew and prepare environment
    - export GRADLE_USER_HOME=`pwd`/.gradle
    - chmod +x ./Frontend/CyLife/gradlew   # Ensure gradlew is executable
  script:
    - cd Frontend/CyLife            # Navigate to the Android project root directory
    - ./gradlew build               # Run gradle build
  only:
    refs:
      - main                        # Trigger only on changes to the 'main' branch
    changes:
      - Frontend/**/*               # Trigger only if changes are made inside the 'Frontend' folder

android-test:
  image: afirefly/android-ci:java17  # Docker image with Android environments installed
  stage: androidtest                # One of the stages listed above
  tags:
    - Dhvani_tag                    # Change to your runner's tag
  before_script:                    # Enable gradlew and prepare environment
    - export GRADLE_USER_HOME=`pwd`/.gradle
    - chmod +x ./Frontend/CyLife/gradlew   # Ensure gradlew is executable
  script:
    - cd Frontend/CyLife            # Navigate to the Android project root directory
    - ./gradlew test                # Run gradle test
  only:
    refs:
      - CI/CD_Dhvani                # Trigger only on changes to the 'CI/CD_Dhvani' branch
    changes:
      - Frontend/**/*               # Trigger only if changes are made inside the 'Frontend' folder

